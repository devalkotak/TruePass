{% extends "base.html" %}

{% block content %}
<h2>ðŸ›’ Your Cart</h2>

{% if cart %}
<div class="grid">
    <div class="card" style="grid-column: span 2;">
        <table style="width:100%; border-collapse:collapse;">
            <thead>
                <tr style="border-bottom:1px solid #ddd; text-align:left;">
                    <th style="padding:10px;">Event</th>
                    <th style="padding:10px;">Price</th>
                    <th style="padding:10px;">Qty</th>
                    <th style="padding:10px;">Subtotal</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for line in cart %}
                <tr style="border-bottom:1px solid #f9f9f9;">
                    <td style="padding:15px;">
                        <strong>{{ line.event.name }}</strong><br>
                        <small>{{ line.event.date }}</small>
                    </td>
                    <td style="padding:15px;">${{ line.item.price_per_item }}</td>
                    <td style="padding:15px;">{{ line.item.quantity }}</td>
                    <td style="padding:15px;">${{ line.subtotal }}</td>
                    <td style="padding:15px;">
                        <a href="{{ url_for('remove_cart', item_id=line.item.id) }}" style="color:red; text-decoration:none;">&times;</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="card">
        <h3>Summary</h3>
        <div style="display:flex; justify-content:space-between; margin:1rem 0;">
            <span>Total Items:</span>
            <strong>{{ cart|length }}</strong>
        </div>
        <div style="display:flex; justify-content:space-between; margin:1rem 0; font-size:1.2rem;">
            <span>Total Cost:</span>
            <strong class="text-accent">${{ total }}</strong>
        </div>
        
        <form action="{{ url_for('checkout') }}" method="POST">
            <button class="btn btn-accent" style="width:100%;">Confirm Purchase</button>
        </form>
        <p style="text-align:center; font-size:0.8rem; margin-top:10px; color:#666;">
            Balance: ${{ current_user.balance }}
        </p>
    </div>
</div>
{% else %}
    <div style="text-align:center; padding:4rem;">
        <p>Your cart is empty.</p>
        <a href="{{ url_for('dashboard') }}" class="btn">Go to Dashboard</a>
    </div>
{% endif %}
{% endblock %}